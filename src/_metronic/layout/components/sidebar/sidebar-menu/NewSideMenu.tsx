import React, { useEffect, useState } from "react";
import { useRecoilValue, useSetRecoilState } from "recoil";
import modeAtomsAtom from "../../../../../app/atoms/modeAtoms.atom";
import pageAtom from "../../../../../app/atoms/pagAtom";
import { Link, useLocation } from "react-router-dom";
import { useAuth } from "../../../../../app/pages/auth";
import logoColored from "../../../../../../public/media/logos/Logo_color.svg";
import logoMono from "../../../../../../public/media/logos/Logo_dark.svg";

type Links = {
  title: string;
  href?: string;
  path: string;
  children?: any[];
  allowedRoles?: string[];
  groupTitle?: string;
  icon: any;
  hasTag?: boolean;
};

const NewSideMenu = () => {
  const { logout } = useAuth();
  const { mode } = useRecoilValue(modeAtomsAtom);
  const setPageTitle = useSetRecoilState(pageAtom);
  const [isOpen, setIsOpen] = useState(false);
  const { pathname } = useLocation();
  const [children, setChildren] = useState<Links[]>([]);
  const [topTitle, setTopTitle] = useState("");
  const [popOpen, setPopOpen] = useState(false);
  const [user, setUser] = useState<any>(null);

  useEffect(() => {
    const localChildren = sessionStorage.getItem("children");
    const localUser = localStorage.getItem("user");
    const localtitle = sessionStorage.getItem("top-title");
    if (localChildren) {
      const parsed = JSON.parse(localChildren);
      setIsOpen(true);
      setChildren(parsed);
      setTopTitle(localtitle!);
    }

    if (localUser) {
      const parsed = JSON.parse(localUser);
      setUser(parsed);
    }
  }, []);

  const links: Links[] = [
    {
      title: "Dashboard",
      href: "/dashboard",
      path: "/dashboard",
      allowedRoles: ["Admin", "Tenant"],
      icon: (
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M9 10.3125C8.48223 10.3125 8.0625 10.7322 8.0625 11.25V13.5C8.0625 13.8107 7.81066 14.0625 7.5 14.0625C7.18934 14.0625 6.9375 13.8107 6.9375 13.5V11.25C6.9375 10.1109 7.86091 9.1875 9 9.1875C10.1391 9.1875 11.0625 10.1109 11.0625 11.25V13.5C11.0625 13.8107 10.8107 14.0625 10.5 14.0625C10.1893 14.0625 9.9375 13.8107 9.9375 13.5V11.25C9.9375 10.7322 9.51777 10.3125 9 10.3125Z"
            fill={
              pathname.includes("/dashboard")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M0.997008 6.25143C0.858077 5.97357 0.970703 5.63569 1.24857 5.49676L8.54732 1.84738C8.83237 1.70486 9.16788 1.70486 9.45293 1.84738L16.7517 5.49676C17.0295 5.63569 17.1422 5.97357 17.0032 6.25143C16.8643 6.5293 16.5264 6.64192 16.2486 6.50299L9.00012 2.87877L1.75168 6.50299C1.47382 6.64192 1.13594 6.5293 0.997008 6.25143Z"
            fill={
              pathname.includes("/dashboard")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M3 7.6875C3.31066 7.6875 3.5625 7.93934 3.5625 8.25V14.25C3.5625 14.7678 3.98223 15.1875 4.5 15.1875H13.5C14.0178 15.1875 14.4375 14.7678 14.4375 14.25V8.25C14.4375 7.93934 14.6893 7.6875 15 7.6875C15.3107 7.6875 15.5625 7.93934 15.5625 8.25V14.25C15.5625 15.3891 14.6391 16.3125 13.5 16.3125H4.5C3.36091 16.3125 2.4375 15.3891 2.4375 14.25V8.25C2.4375 7.93934 2.68934 7.6875 3 7.6875Z"
            fill={
              pathname.includes("/dashboard")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
        </svg>
      ),
      children: [
        {
          title: "Dashboard",
          href: "/dashboard",
          children: [],
        },
      ],
    },
    {
      title: "Cloud Management",
      href: "/cloud-provider/cloud/provider-resource",
      path: "/cloud-provider",
      allowedRoles: ["Admin", "Tenant"],
      icon: (
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M5.60283 13.1023C5.8225 12.8826 6.17865 12.8826 6.39832 13.1023L8.25057 14.9545L11.6028 11.6023C11.8225 11.3826 12.1787 11.3826 12.3983 11.6023C12.618 11.8219 12.618 12.1781 12.3983 12.3977L8.64832 16.1477C8.42865 16.3674 8.0725 16.3674 7.85283 16.1477L5.60283 13.8977C5.38316 13.6781 5.38316 13.3219 5.60283 13.1023Z"
            fill={
              pathname.includes("/cloud-provider")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M5.54484 3.4769C5.07414 4.2614 5.0625 5.22927 5.0625 6C5.0625 6.31066 4.81066 6.5625 4.5 6.5625C3.96501 6.5625 3.15001 6.72762 2.48492 7.20649C1.84851 7.6647 1.3125 8.43333 1.3125 9.75C1.3125 10.6466 1.56117 11.2788 1.90304 11.7295C2.24942 12.1861 2.71814 12.4909 3.20516 12.6817C3.49442 12.795 3.63706 13.1213 3.52375 13.4106C3.41044 13.6999 3.0841 13.8425 2.79484 13.7292C2.16157 13.4811 1.50529 13.0666 1.00674 12.4094C0.503685 11.7462 0.1875 10.8701 0.1875 9.75C0.1875 8.06667 0.901487 6.9603 1.82758 6.29351C2.51299 5.80002 3.29324 5.56101 3.9422 5.47562C3.96186 4.74186 4.06295 3.76011 4.58016 2.8981C5.27204 1.74497 6.61302 0.9375 9 0.9375C11.387 0.9375 12.728 1.74497 13.4198 2.8981C13.937 3.76011 14.0381 4.74186 14.0578 5.47562C14.7068 5.56101 15.487 5.80002 16.1724 6.29351C17.0985 6.9603 17.8125 8.06667 17.8125 9.75C17.8125 10.8701 17.4963 11.7462 16.9933 12.4094C16.4947 13.0666 15.8384 13.4811 15.2052 13.7292C14.9159 13.8425 14.5896 13.6999 14.4762 13.4106C14.3629 13.1213 14.5056 12.795 14.7948 12.6817C15.2819 12.4909 15.7506 12.1861 16.097 11.7295C16.4388 11.2788 16.6875 10.6466 16.6875 9.75C16.6875 8.43333 16.1515 7.6647 15.5151 7.20649C14.85 6.72762 14.035 6.5625 13.5 6.5625C13.1893 6.5625 12.9375 6.31066 12.9375 6C12.9375 5.22927 12.9259 4.2614 12.4552 3.4769C12.022 2.75503 11.113 2.0625 9 2.0625C6.88698 2.0625 5.97796 2.75503 5.54484 3.4769Z"
            fill={
              pathname.includes("/cloud-provider")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
        </svg>
      ),
      children: [
        {
          title: "Cloud Providers",
          href: "/cloud-provider/cloud/provider-resource",
          children: [],
        },
        {
          title: "Cloud Region",
          href: "/cloud-provider/cloud/region",
          children: [],
        },
        {
          title: "Resource Inventory",
          href: "/assets/assets-list",
          children: [],
        },
        {
          title: "Suppression Setup",
          href: "/cloud-provider/cloud/suppression-setup",
          children: [],
        },
        {
          title: "Suppression Logs",
          href: "/cloud-provider/cloud/suppression-logs",
          children: [],
        },
      ],
    },
    {
      title: "Security Monitoring",
      href: "/monitoring/resource-scanning",
      path: "/monitoring",
      allowedRoles: ["Admin", "Tenant"],
      icon: (
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g clipPath="url(#clip0_3155_103)">
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M4.6875 16.5C4.6875 16.1893 4.93934 15.9375 5.25 15.9375L12.75 15.9375C13.0607 15.9375 13.3125 16.1893 13.3125 16.5C13.3125 16.8107 13.0607 17.0625 12.75 17.0625L5.25 17.0625C4.93934 17.0625 4.6875 16.8107 4.6875 16.5Z"
              fill={
                pathname.includes("/monitoring")
                  ? "#284CB3"
                  : mode === "dark"
                  ? "#EAEAEA"
                  : "#000000"
              }
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M3 2.0625C2.48223 2.0625 2.0625 2.48223 2.0625 3V12.75C2.0625 13.2678 2.48223 13.6875 3 13.6875H15C15.5178 13.6875 15.9375 13.2678 15.9375 12.75V3C15.9375 2.48223 15.5178 2.0625 15 2.0625H3ZM0.9375 3C0.9375 1.86091 1.86091 0.9375 3 0.9375H15C16.1391 0.9375 17.0625 1.86091 17.0625 3V12.75C17.0625 13.8891 16.1391 14.8125 15 14.8125H3C1.86091 14.8125 0.9375 13.8891 0.9375 12.75V3Z"
              fill={
                pathname.includes("/monitoring")
                  ? "#284CB3"
                  : mode === "dark"
                  ? "#EAEAEA"
                  : "#000000"
              }
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M6.35283 7.47725C6.5725 7.25758 6.92865 7.25758 7.14832 7.47725L8.25057 8.57951L10.8528 5.97725C11.0725 5.75758 11.4287 5.75758 11.6483 5.97725C11.868 6.19692 11.868 6.55308 11.6483 6.77275L8.64832 9.77275C8.54283 9.87824 8.39976 9.9375 8.25057 9.9375C8.10139 9.9375 7.95832 9.87824 7.85283 9.77275L6.35283 8.27275C6.13316 8.05308 6.13316 7.69692 6.35283 7.47725Z"
              fill={
                pathname.includes("/monitoring")
                  ? "#284CB3"
                  : mode === "dark"
                  ? "#EAEAEA"
                  : "#000000"
              }
            />
          </g>
          <defs>
            <clipPath id="clip0_3155_103">
              <rect width="18" height="18" fill="white" />
            </clipPath>
          </defs>
        </svg>
      ),
      children: [
        {
          title: "Resource Scanning",
          href: "/monitoring/resource-scanning",
          children: [],
        },
        {
          title: "Scan Report",
          href: "/monitoring/scan-history",
          children: [],
        },
        {
          title: "CloudTrails",
          href: "/monitoring/cloudtrail-setup",
          children: [],
        },
      ],
    },
    {
      title: "Workload Protection",
      href: "/workload-protection/overview",
      path: "/workload-protection",
      allowedRoles: ["Admin", "Tenant"],
      icon: (
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M3.1875 13.5V9H4.3125V13.4859C4.31292 13.4896 4.3137 13.4958 4.3151 13.5042C4.31964 13.5315 4.3306 13.5816 4.35628 13.6477C4.40641 13.7766 4.51786 13.9798 4.77232 14.1979C5.28525 14.6376 6.44231 15.1875 9 15.1875C11.5577 15.1875 12.7147 14.6376 13.2277 14.1979C13.4821 13.9798 13.5936 13.7766 13.6437 13.6477C13.6694 13.5816 13.6804 13.5315 13.6849 13.5042C13.6863 13.4958 13.6871 13.4896 13.6875 13.4859V9H14.8125V13.5H14.25C14.8125 13.5 14.8125 13.5007 14.8125 13.5013L14.8125 13.5027L14.8125 13.5056L14.8124 13.512L14.8119 13.5276C14.8115 13.5391 14.8108 13.5529 14.8095 13.5689C14.807 13.6008 14.8026 13.6413 14.7946 13.6892C14.7786 13.7849 14.7486 13.9105 14.6922 14.0554C14.5783 14.3484 14.3616 14.7077 13.9598 15.0521C13.1603 15.7374 11.6923 16.3125 9 16.3125C6.30769 16.3125 4.83975 15.7374 4.04018 15.0521C3.63839 14.7077 3.42172 14.3484 3.30778 14.0554C3.25143 13.9105 3.22137 13.7849 3.20541 13.6892C3.19743 13.6413 3.19295 13.6008 3.19048 13.5689C3.18924 13.5529 3.18849 13.5391 3.18806 13.5276L3.18762 13.512L3.18753 13.5056L3.18751 13.5027L3.1875 13.5013C3.1875 13.5007 3.1875 13.5 3.75 13.5H3.1875Z"
            fill={
              pathname.includes("/workload-protection")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M3.1875 9V4.5H4.3125V8.98586C4.31292 8.98964 4.3137 8.99582 4.3151 9.00421C4.31964 9.03147 4.3306 9.08165 4.35628 9.14769C4.40641 9.27657 4.51786 9.47981 4.77232 9.69792C5.28525 10.1376 6.44231 10.6875 9 10.6875C11.5577 10.6875 12.7147 10.1376 13.2277 9.69792C13.4821 9.47981 13.5936 9.27657 13.6437 9.14769C13.6694 9.08165 13.6804 9.03147 13.6849 9.00421C13.6863 8.99582 13.6871 8.98964 13.6875 8.98586V4.5H14.8125V9H14.25C14.8125 9 14.8125 9.00065 14.8125 9.00131L14.8125 9.00268L14.8125 9.00558L14.8124 9.01205L14.8119 9.02761C14.8115 9.03913 14.8108 9.05294 14.8095 9.06889C14.807 9.10076 14.8026 9.14127 14.7946 9.18915C14.7786 9.28493 14.7486 9.41054 14.6922 9.55544C14.5783 9.84843 14.3616 10.2077 13.9598 10.5521C13.1603 11.2374 11.6923 11.8125 9 11.8125C6.30769 11.8125 4.83975 11.2374 4.04018 10.5521C3.63839 10.2077 3.42172 9.84843 3.30778 9.55544C3.25143 9.41054 3.22137 9.28493 3.20541 9.18915C3.19743 9.14127 3.19295 9.10076 3.19048 9.06889C3.18924 9.05294 3.18849 9.03913 3.18806 9.02761L3.18762 9.01205L3.18753 9.00558L3.18751 9.00268L3.1875 9.00131C3.1875 9.00065 3.1875 9 3.75 9H3.1875Z"
            fill={
              pathname.includes("/workload-protection")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M4.04018 2.94792C4.83975 2.26257 6.30769 1.6875 9 1.6875C11.6923 1.6875 13.1603 2.26257 13.9598 2.94792C14.3616 3.29231 14.5783 3.65157 14.6922 3.94456C14.7486 4.08946 14.7786 4.21507 14.7946 4.31085C14.8026 4.35873 14.807 4.39924 14.8095 4.43111C14.8108 4.44706 14.8115 4.46087 14.8119 4.47239L14.8124 4.48795L14.8125 4.49442L14.8125 4.49732L14.8125 4.49869C14.8125 4.49935 14.8125 4.5 14.25 4.5C14.8125 4.5 14.8125 4.50065 14.8125 4.50131L14.8125 4.50268L14.8125 4.50558L14.8124 4.51205L14.8119 4.52761C14.8115 4.53913 14.8108 4.55294 14.8095 4.56889C14.807 4.60076 14.8026 4.64127 14.7946 4.68915C14.7786 4.78493 14.7486 4.91054 14.6922 5.05544C14.5783 5.34843 14.3616 5.70769 13.9598 6.05208C13.1603 6.73743 11.6923 7.3125 9 7.3125C6.30769 7.3125 4.83975 6.73743 4.04018 6.05208C3.63839 5.70769 3.42172 5.34843 3.30778 5.05544C3.25143 4.91054 3.22137 4.78493 3.20541 4.68915C3.19743 4.64127 3.19295 4.60076 3.19047 4.56889C3.18923 4.55294 3.18849 4.53913 3.18806 4.52761L3.18761 4.51205L3.18752 4.50558L3.1875 4.50268L3.1875 4.50131C3.1875 4.50065 3.1875 4.5 3.75 4.5C3.1875 4.5 3.1875 4.49935 3.1875 4.49869L3.1875 4.49732L3.18752 4.49442L3.18761 4.48795L3.18806 4.47239C3.18849 4.46087 3.18923 4.44706 3.19047 4.43111C3.19295 4.39924 3.19743 4.35873 3.20541 4.31085C3.22137 4.21507 3.25143 4.08946 3.30778 3.94456C3.42172 3.65157 3.63839 3.29231 4.04018 2.94792ZM4.31442 4.5C4.31463 4.50133 4.31485 4.50274 4.3151 4.50421C4.31964 4.53147 4.3306 4.58165 4.35628 4.64769C4.4064 4.77657 4.51785 4.97981 4.77232 5.19792C5.28525 5.63757 6.4423 6.1875 9 6.1875C11.5577 6.1875 12.7147 5.63757 13.2277 5.19792C13.4821 4.97981 13.5936 4.77657 13.6437 4.64769C13.6694 4.58165 13.6804 4.53147 13.6849 4.50421C13.6851 4.50274 13.6854 4.50133 13.6856 4.5C13.6854 4.49867 13.6851 4.49726 13.6849 4.49579C13.6804 4.46853 13.6694 4.41835 13.6437 4.35231C13.5936 4.22343 13.4821 4.02019 13.2277 3.80208C12.7147 3.36243 11.5577 2.8125 9 2.8125C6.4423 2.8125 5.28525 3.36243 4.77232 3.80208C4.51785 4.02019 4.4064 4.22343 4.35628 4.35231C4.3306 4.41835 4.31964 4.46853 4.3151 4.49579C4.31485 4.49726 4.31463 4.49867 4.31442 4.5Z"
            fill={
              pathname.includes("/workload-protection")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
        </svg>
      ),
      children: [
        {
          title: "Overview",
          href: "/workload-protection/overview",
          children: [],
        },
        {
          title: "Container Security",
          href: "",
          children: [
            {
              title: "Container Assets",
              href: "/workload-protection/container/container-assets",
            },
            {
              title: "Container scans",
              href: "/workload-protection/container/container-scan",
            },
            {
              title: "Policies",
              href: "/workload-protection/container/policies",
            },
          ],
        },
        {
          title: " Infrastructure as Code Security",
          href: "",
          children: [
            {
              title: "Templates",
              href: "/workload-protection/iac/templates",
            },
            {
              title: "IAC Vulnerability",
              href: "/workload-protection/iac/iac-vulnerability",
            },
            {
              title: "Policies",
              href: "/workload-protection/iac/policies",
            },
          ],
        },
      ],
    },
    {
      title: "Repository MANAGEMENT",
      href: "/repository/list",
      path: "/repository",
      allowedRoles: ["Admin", "Tenant"],
      icon: (
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g clipPath="url(#clip0_3155_123)">
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M4.8838 13.0819C5.11471 13.2897 5.13343 13.6454 4.92561 13.8763L4.91811 13.8846C4.71029 14.1155 4.35462 14.1343 4.12371 13.9264C3.8928 13.7186 3.87408 13.363 4.0819 13.132L4.0894 13.1237C4.29722 12.8928 4.65289 12.8741 4.8838 13.0819Z"
              fill={
                pathname.includes("/repository")
                  ? "#284CB3"
                  : mode === "dark"
                  ? "#EAEAEA"
                  : "#000000"
              }
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M4.8838 4.0819C5.11471 4.28972 5.13343 4.64539 4.92561 4.8763L4.91811 4.88463C4.71029 5.11554 4.35462 5.13426 4.12371 4.92644C3.8928 4.71862 3.87408 4.36296 4.0819 4.13205L4.0894 4.12371C4.29722 3.8928 4.65289 3.87408 4.8838 4.0819Z"
              fill={
                pathname.includes("/repository")
                  ? "#284CB3"
                  : mode === "dark"
                  ? "#EAEAEA"
                  : "#000000"
              }
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M2.0625 2.0625V6.9375H15.9375V2.0625H2.0625ZM0.9375 1.95C0.9375 1.39081 1.39081 0.9375 1.95 0.9375H16.05C16.6092 0.9375 17.0625 1.39081 17.0625 1.95V7.05C17.0625 7.60919 16.6092 8.0625 16.05 8.0625H1.95C1.39081 8.0625 0.9375 7.60919 0.9375 7.05V1.95Z"
              fill={
                pathname.includes("/repository")
                  ? "#284CB3"
                  : mode === "dark"
                  ? "#EAEAEA"
                  : "#000000"
              }
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M2.0625 11.0625V15.9375H15.9375V11.0625H2.0625ZM0.9375 10.95C0.9375 10.3908 1.39081 9.9375 1.95 9.9375H16.05C16.6092 9.9375 17.0625 10.3908 17.0625 10.95V16.05C17.0625 16.6092 16.6092 17.0625 16.05 17.0625H1.95C1.39081 17.0625 0.9375 16.6092 0.9375 16.05V10.95Z"
              fill={
                pathname.includes("/repository")
                  ? "#284CB3"
                  : mode === "dark"
                  ? "#EAEAEA"
                  : "#000000"
              }
            />
          </g>
          <defs>
            <clipPath id="clip0_3155_123">
              <rect width="18" height="18" fill="white" />
            </clipPath>
          </defs>
        </svg>
      ),
      children: [
        {
          title: "Repository",
          href: "/repository/list",
          children: [],
        },
        {
          title: "Repository Scan",
          href: "/repository/scan",
          children: [],
        },
        {
          title: "Scan history",
          href: "/repository/scan-history",
          children: [],
        },
      ],
    },
    {
      title: "Compliance Management",
      href: "/policy/policies",
      path: "/policy",
      allowedRoles: ["Admin", "Tenant"],
      icon: (
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M3.5625 2.0625V15.9375H9.75C10.0607 15.9375 10.3125 16.1893 10.3125 16.5C10.3125 16.8107 10.0607 17.0625 9.75 17.0625H3.45C2.89081 17.0625 2.4375 16.6092 2.4375 16.05V1.95C2.4375 1.39081 2.89081 0.9375 3.45 0.9375H12.1886C12.4571 0.9375 12.7147 1.04417 12.9045 1.23405L15.2659 3.59545C15.4558 3.78533 15.5625 4.04286 15.5625 4.3114V9C15.5625 9.31066 15.3107 9.5625 15 9.5625C14.6893 9.5625 14.4375 9.31066 14.4375 9V4.358L12.142 2.0625H3.5625Z"
            fill={
              pathname.includes("/policy")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M5.4375 4.5C5.4375 4.18934 5.68934 3.9375 6 3.9375H9C9.31066 3.9375 9.5625 4.18934 9.5625 4.5C9.5625 4.81066 9.31066 5.0625 9 5.0625H6C5.68934 5.0625 5.4375 4.81066 5.4375 4.5ZM5.4375 7.5C5.4375 7.18934 5.68934 6.9375 6 6.9375H12C12.3107 6.9375 12.5625 7.18934 12.5625 7.5C12.5625 7.81066 12.3107 8.0625 12 8.0625H6C5.68934 8.0625 5.4375 7.81066 5.4375 7.5ZM5.4375 10.5C5.4375 10.1893 5.68934 9.9375 6 9.9375H8.25C8.56066 9.9375 8.8125 10.1893 8.8125 10.5C8.8125 10.8107 8.56066 11.0625 8.25 11.0625H6C5.68934 11.0625 5.4375 10.8107 5.4375 10.5Z"
            fill={
              pathname.includes("/policy")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M12 0.9375C12.3107 0.9375 12.5625 1.18934 12.5625 1.5V3.9375H15C15.3107 3.9375 15.5625 4.18934 15.5625 4.5C15.5625 4.81066 15.3107 5.0625 15 5.0625H12.45C11.8908 5.0625 11.4375 4.60919 11.4375 4.05V1.5C11.4375 1.18934 11.6893 0.9375 12 0.9375Z"
            fill={
              pathname.includes("/policy")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M14.1182 10.7978C14.4514 10.7132 14.8004 10.7132 15.1336 10.7978L17.0501 11.2846C17.4975 11.3982 17.8222 11.8073 17.808 12.2843C17.7402 14.5581 17.0452 15.9373 16.3045 16.7554C15.9381 17.16 15.5715 17.4151 15.2884 17.571C15.1469 17.6488 15.0264 17.7019 14.9369 17.7366C14.8922 17.754 14.8551 17.7669 14.827 17.776C14.8129 17.7805 14.8011 17.7841 14.7916 17.7869L14.7793 17.7905L14.7745 17.7918L14.7724 17.7923L14.7715 17.7926C14.771 17.7927 14.7706 17.7928 14.6259 17.2493C14.4812 17.7928 14.4808 17.7927 14.4803 17.7926L14.4794 17.7923L14.4773 17.7918L14.4725 17.7905L14.4601 17.7869C14.4507 17.7841 14.4388 17.7805 14.4248 17.776C14.3967 17.7669 14.3596 17.754 14.3149 17.7366C14.2254 17.7019 14.1048 17.6488 13.9634 17.571C13.6802 17.4151 13.3136 17.16 12.9473 16.7554C12.2066 15.9373 11.5116 14.5581 11.4438 12.2843C11.4296 11.8073 11.7542 11.3982 12.2017 11.2846L14.1182 10.7978ZM14.6259 17.2493L14.4812 17.7928C14.576 17.8181 14.6758 17.8181 14.7706 17.7928L14.6259 17.2493ZM14.6259 16.6465C14.661 16.6301 14.7013 16.6099 14.7459 16.5854C14.9338 16.482 15.198 16.3013 15.4705 16.0003C15.9987 15.417 16.6022 14.3321 16.68 12.3513L14.8567 11.8882C14.7052 11.8498 14.5466 11.8498 14.3951 11.8882L12.5718 12.3513C12.6496 14.3321 13.2531 15.417 13.7812 16.0003C14.0538 16.3013 14.318 16.482 14.5059 16.5854C14.5505 16.6099 14.5908 16.6301 14.6259 16.6465Z"
            fill={
              pathname.includes("/policy")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
        </svg>
      ),
      children: [
        {
          title: "Regulatory Compliance",
          href: "",
          children: [],
        },
        {
          title: "Policy Enforcement",
          href: "/policy/policies",
          children: [],
        },
        {
          title: "Rules and Benchmarks",
          href: "/policy/rule-list",
          children: [],
        },
        {
          title: "Audit Logs",
          href: "",
          children: [],
        },
      ],
    },
    {
      title: "User Management",
      href: "/account-manager/users/all-users",
      path: "/account-manager",
      allowedRoles: ["Admin"],
      icon: (
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M8.71826 2.5132C8.89259 2.41227 9.10759 2.41227 9.28193 2.5132L16.4069 6.6382C16.6758 6.79385 16.7675 7.13798 16.6119 7.40683C16.4562 7.67569 16.1121 7.76745 15.8433 7.6118L9.00009 3.64997L2.15693 7.6118C1.88807 7.76745 1.54394 7.67569 1.38829 7.40683C1.23264 7.13798 1.32441 6.79385 1.59326 6.6382L8.71826 2.5132Z"
            fill={
              pathname.includes("/account-manager")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M9 11.8125C7.23959 11.8125 5.8125 13.2396 5.8125 15V15.75H4.6875V15C4.6875 12.6183 6.61827 10.6875 9 10.6875C11.3817 10.6875 13.3125 12.6183 13.3125 15V15.75H12.1875V15C12.1875 13.2396 10.7604 11.8125 9 11.8125Z"
            fill={
              pathname.includes("/account-manager")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M9 7.3125C8.06802 7.3125 7.3125 8.06802 7.3125 9C7.3125 9.93198 8.06802 10.6875 9 10.6875C9.93198 10.6875 10.6875 9.93198 10.6875 9C10.6875 8.06802 9.93198 7.3125 9 7.3125ZM6.1875 9C6.1875 7.4467 7.4467 6.1875 9 6.1875C10.5533 6.1875 11.8125 7.4467 11.8125 9C11.8125 10.5533 10.5533 11.8125 9 11.8125C7.4467 11.8125 6.1875 10.5533 6.1875 9Z"
            fill={
              pathname.includes("/account-manager")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
        </svg>
      ),
      children: [
        {
          title: "All Users",
          href: "/account-manager/users/all-users",
          children: [],
        },
        {
          title: "Tenants",
          href: "/account-manager/account/tenants",
          children: [],
        },
        {
          title: "User Logs",
          href: "/account-manager/users/user-logs",
          children: [],
        },
        {
          title: "Roles and Permission",
          href: "/account-manager/account/roles",
          children: [],
        },
      ],
    },
    {
      title: "Reports",
      href: "/reports/template",
      path: "/reports",
      allowedRoles: ["Admin", "Tenant"],
      icon: (
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M3.5625 2.0625V15.9375H9.75C10.0607 15.9375 10.3125 16.1893 10.3125 16.5C10.3125 16.8107 10.0607 17.0625 9.75 17.0625H3.45C2.89081 17.0625 2.4375 16.6092 2.4375 16.05V1.95C2.4375 1.39081 2.89081 0.9375 3.45 0.9375H12.1886C12.4571 0.9375 12.7147 1.04417 12.9045 1.23405L15.2659 3.59545C15.4558 3.78533 15.5625 4.04286 15.5625 4.3114V9C15.5625 9.31066 15.3107 9.5625 15 9.5625C14.6893 9.5625 14.4375 9.31066 14.4375 9V4.358L12.142 2.0625H3.5625Z"
            fill={
              pathname.includes("/reports")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M5.4375 4.5C5.4375 4.18934 5.68934 3.9375 6 3.9375H9C9.31066 3.9375 9.5625 4.18934 9.5625 4.5C9.5625 4.81066 9.31066 5.0625 9 5.0625H6C5.68934 5.0625 5.4375 4.81066 5.4375 4.5ZM5.4375 7.5C5.4375 7.18934 5.68934 6.9375 6 6.9375H12C12.3107 6.9375 12.5625 7.18934 12.5625 7.5C12.5625 7.81066 12.3107 8.0625 12 8.0625H6C5.68934 8.0625 5.4375 7.81066 5.4375 7.5ZM5.4375 10.5C5.4375 10.1893 5.68934 9.9375 6 9.9375H8.25C8.56066 9.9375 8.8125 10.1893 8.8125 10.5C8.8125 10.8107 8.56066 11.0625 8.25 11.0625H6C5.68934 11.0625 5.4375 10.8107 5.4375 10.5Z"
            fill={
              pathname.includes("/reports")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M12 0.9375C12.3107 0.9375 12.5625 1.18934 12.5625 1.5V3.9375H15C15.3107 3.9375 15.5625 4.18934 15.5625 4.5C15.5625 4.81066 15.3107 5.0625 15 5.0625H12.45C11.8908 5.0625 11.4375 4.60919 11.4375 4.05V1.5C11.4375 1.18934 11.6893 0.9375 12 0.9375Z"
            fill={
              pathname.includes("/reports")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M14.1182 10.7978C14.4514 10.7132 14.8004 10.7132 15.1336 10.7978L17.0501 11.2846C17.4975 11.3982 17.8222 11.8073 17.808 12.2843C17.7402 14.5581 17.0452 15.9373 16.3045 16.7554C15.9381 17.16 15.5715 17.4151 15.2884 17.571C15.1469 17.6488 15.0264 17.7019 14.9369 17.7366C14.8922 17.754 14.8551 17.7669 14.827 17.776C14.8129 17.7805 14.8011 17.7841 14.7916 17.7869L14.7793 17.7905L14.7745 17.7918L14.7724 17.7923L14.7715 17.7926C14.771 17.7927 14.7706 17.7928 14.6259 17.2493C14.4812 17.7928 14.4808 17.7927 14.4803 17.7926L14.4794 17.7923L14.4773 17.7918L14.4725 17.7905L14.4601 17.7869C14.4507 17.7841 14.4388 17.7805 14.4248 17.776C14.3967 17.7669 14.3596 17.754 14.3149 17.7366C14.2254 17.7019 14.1048 17.6488 13.9634 17.571C13.6802 17.4151 13.3136 17.16 12.9473 16.7554C12.2066 15.9373 11.5116 14.5581 11.4438 12.2843C11.4296 11.8073 11.7542 11.3982 12.2017 11.2846L14.1182 10.7978ZM14.6259 17.2493L14.4812 17.7928C14.576 17.8181 14.6758 17.8181 14.7706 17.7928L14.6259 17.2493ZM14.6259 16.6465C14.661 16.6301 14.7013 16.6099 14.7459 16.5854C14.9338 16.482 15.198 16.3013 15.4705 16.0003C15.9987 15.417 16.6022 14.3321 16.68 12.3513L14.8567 11.8882C14.7052 11.8498 14.5466 11.8498 14.3951 11.8882L12.5718 12.3513C12.6496 14.3321 13.2531 15.417 13.7812 16.0003C14.0538 16.3013 14.318 16.482 14.5059 16.5854C14.5505 16.6099 14.5908 16.6301 14.6259 16.6465Z"
            fill={
              pathname.includes("/reports")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
        </svg>
      ),
      children: [
        {
          title: "Report Templates",
          href: "/reports/template",
          children: [],
        },
        {
          title: "Report History",
          href: "/reports/history",
          children: [],
        },
      ],
    },
    {
      title: "Integration",
      href: "/integration/new-integration",
      path: "/integration",
      allowedRoles: ["Admin", "Tenant"],
      icon: (
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M3.9375 3.75C3.9375 3.43934 4.18934 3.1875 4.5 3.1875H13.5C13.8107 3.1875 14.0625 3.43934 14.0625 3.75V9.75C14.0625 10.0607 13.8107 10.3125 13.5 10.3125H9.5625V13.6875H15.75C16.0607 13.6875 16.3125 13.9393 16.3125 14.25C16.3125 14.5607 16.0607 14.8125 15.75 14.8125H2.25C1.93934 14.8125 1.6875 14.5607 1.6875 14.25C1.6875 13.9393 1.93934 13.6875 2.25 13.6875H8.4375V10.3125H4.5C4.18934 10.3125 3.9375 10.0607 3.9375 9.75V3.75ZM5.0625 4.3125V9.1875H12.9375V4.3125H5.0625Z"
            fill={
              pathname.includes("integration/")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M7.13382 6.33192C7.36472 6.53975 7.38342 6.89542 7.17559 7.12632L7.16809 7.13465C6.96026 7.36555 6.60459 7.38425 6.37369 7.17642C6.14279 6.96859 6.12409 6.61293 6.33192 6.38203L6.33942 6.37369C6.54725 6.14279 6.90292 6.12409 7.13382 6.33192Z"
            fill={
              pathname.includes("integration/")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M9.38382 6.33192C9.61472 6.53975 9.63342 6.89542 9.42559 7.12632L9.41809 7.13465C9.21026 7.36555 8.85459 7.38425 8.62369 7.17642C8.39279 6.96859 8.37409 6.61293 8.58192 6.38203L8.58942 6.37369C8.79725 6.14279 9.15292 6.12409 9.38382 6.33192Z"
            fill={
              pathname.includes("integration/")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
        </svg>
      ),
      children: [
        {
          title: "New Integrations",
          href: "/integration/new-integration",
          children: [],
        },
        {
          title: "Configured Integrations",
          href: "/integration/configured-integration",
          children: [],
        },
        {
          title: "Plugins",
          href: "/integration/plugins",
          children: [],
          hasTag: true,
        },
        // {
        //   title: "Setup Task Types",
        //   href: "tickets/ticket-types",
        // },
        // {
        //   title: "Tasks list",
        //   href: "/tickets/tickets-list",
        // },
        // {
        //   title: "Notifications",
        //   href: "",
        // },
        // {
        //   title: "Payment Gateways",
        //   href: "",
        // },
      ],
    },
    {
      title: "Settings",
      href: "/settings/user-management",
      path: "/settings",
      allowedRoles: ["Admin", "Tenant"],
      icon: (
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g clipPath="url(#clip0_3155_1476)">
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M9 7.3125C8.06802 7.3125 7.3125 8.06802 7.3125 9C7.3125 9.93198 8.06802 10.6875 9 10.6875C9.93198 10.6875 10.6875 9.93198 10.6875 9C10.6875 8.06802 9.93198 7.3125 9 7.3125ZM6.1875 9C6.1875 7.4467 7.4467 6.1875 9 6.1875C10.5533 6.1875 11.8125 7.4467 11.8125 9C11.8125 10.5533 10.5533 11.8125 9 11.8125C7.4467 11.8125 6.1875 10.5533 6.1875 9Z"
              fill={
                pathname.includes("/settings")
                  ? "#284CB3"
                  : mode === "dark"
                  ? "#EAEAEA"
                  : "#000000"
              }
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M7.69176 1.35684C7.75679 1.10973 7.98021 0.9375 8.23573 0.9375H9.7015C9.95712 0.9375 10.1806 1.10986 10.2455 1.3571L10.6412 2.86358L12.0945 3.46122L13.1346 2.57238C13.3578 2.38163 13.6901 2.39464 13.8977 2.60225L15.3977 4.10225C15.6046 4.30906 15.6184 4.63985 15.4295 4.86319L14.5444 5.91005L15.1286 7.32087L16.6386 7.70485C16.888 7.76825 17.0625 7.99275 17.0625 8.25004L17.0624 9.73292C17.0624 9.98902 16.8894 10.2128 16.6416 10.2773L15.123 10.6724L14.538 12.0851L15.4291 13.1363C15.6184 13.3596 15.6048 13.6907 15.3977 13.8977L13.8977 15.3977C13.6865 15.609 13.3469 15.6183 13.1244 15.4188L13.0828 15.3815C13.0558 15.3574 13.0168 15.3226 12.9688 15.2801C12.8729 15.195 12.7418 15.0793 12.6006 14.9564C12.4265 14.8049 12.248 14.6521 12.1027 14.5322L10.6794 15.1216L10.2953 16.6381C10.2321 16.8877 10.0075 17.0625 9.75 17.0625H8.25C7.99239 17.0625 7.7677 16.8875 7.70462 16.6377L7.32175 15.1217L5.9391 14.5528L4.85535 15.436C4.63166 15.6183 4.3063 15.6018 4.10225 15.3977L2.60225 13.8977C2.39143 13.6869 2.38172 13.3482 2.58012 13.1257L3.48043 12.1158L2.88877 10.7122L1.35186 10.2926C1.1072 10.2259 0.9375 10.0036 0.9375 9.75V8.25C0.9375 7.98859 1.11759 7.76163 1.37216 7.70222L2.86802 7.35313L3.44358 5.93801L2.56343 4.8547C2.38167 4.63098 2.39843 4.30607 2.60225 4.10225L4.10225 2.60225C4.3129 2.39161 4.65124 2.38172 4.87383 2.5797L5.88691 3.48076L7.28827 2.89003L7.69176 1.35684ZM8.66936 2.0625L8.30579 3.444C8.26137 3.61278 8.14113 3.75138 7.98031 3.81917L5.99681 4.6553C5.79697 4.73954 5.56651 4.7014 5.40447 4.55728L4.52259 3.7729L3.75646 4.53903L4.5266 5.48694C4.65603 5.64625 4.68841 5.86342 4.61108 6.05356L3.80043 8.04667C3.73164 8.21581 3.58503 8.34103 3.40721 8.38253L2.0625 8.69634V9.32048L3.44898 9.69899C3.61559 9.74448 3.75208 9.86399 3.81917 10.0231L4.65514 12.0063C4.73947 12.2064 4.70115 12.4371 4.55669 12.5991L3.77333 13.4778L4.53849 14.243L5.48802 13.4692C5.648 13.3388 5.86652 13.3065 6.05738 13.385L8.01177 14.189C8.17657 14.2568 8.2995 14.3987 8.34314 14.5715L8.68811 15.9375H9.31221L9.65811 14.5718C9.70172 14.3996 9.82408 14.2581 9.98818 14.1902L11.9761 13.367C12.1555 13.2927 12.3605 13.3161 12.5184 13.429C12.7107 13.5665 13.0601 13.8649 13.3392 14.1079C13.3865 14.149 13.4325 14.1893 13.4766 14.2279L14.2359 13.4686L13.4579 12.5508C13.3216 12.39 13.2866 12.1666 13.3672 11.9719L14.1907 9.9833C14.2582 9.82039 14.3981 9.69854 14.5688 9.65414L15.9374 9.29801L15.9375 8.68736L14.5781 8.3417C14.4062 8.29797 14.2649 8.17568 14.1971 8.01176L13.3738 6.02381C13.2933 5.82933 13.3281 5.60615 13.464 5.44541L14.2364 4.5319L13.47 3.76553L12.564 4.53984C12.4035 4.67696 12.1798 4.71272 11.9846 4.63244L9.95438 3.79753C9.79128 3.73046 9.66908 3.59077 9.62428 3.4202L9.26767 2.0625H8.66936Z"
              fill={
                pathname.includes("/settings")
                  ? "#284CB3"
                  : mode === "dark"
                  ? "#EAEAEA"
                  : "#000000"
              }
            />
          </g>
          <defs>
            <clipPath id="clip0_3155_1476">
              <rect width="18" height="18" fill="white" />
            </clipPath>
          </defs>
        </svg>
      ),
      children: [
        {
          title: "User Management",
          href: "/settings/user-management",
          children: [],
        },
        {
          title: "Account Profile",
          href: "/settings/account-setting",
          children: [],
        },
        {
          title: "Notifications",
          href: "/settings/notifications",
          children: [],
        },
        {
          title: "Audit Logs",
          href: "/settings/audit-logs",
          children: [],
        },
      ],
    },
    {
      title: "Plans and Billings",
      href: "/billing",
      path: "/billing",
      allowedRoles: ["Admin", "Tenant"],
      icon: (
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          color={
            pathname.includes("/billing")
              ? "#284CB3"
              : mode === "dark"
              ? "#EAEAEA"
              : "#000000"
          }
        >
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M1.6875 6.75C1.6875 5.61091 2.61091 4.6875 3.75 4.6875H14.25C15.3891 4.6875 16.3125 5.61091 16.3125 6.75V13.5C16.3125 14.6391 15.3891 15.5625 14.25 15.5625H3.75C2.61091 15.5625 1.6875 14.6391 1.6875 13.5V6.75ZM3.75 5.8125C3.23223 5.8125 2.8125 6.23223 2.8125 6.75V13.5C2.8125 14.0178 3.23223 14.4375 3.75 14.4375H14.25C14.7678 14.4375 15.1875 14.0178 15.1875 13.5V6.75C15.1875 6.23223 14.7678 5.8125 14.25 5.8125H3.75Z"
            fill={
              pathname.includes("/billing")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            d="M12.375 10.5C12.1679 10.5 12 10.3321 12 10.125C12 9.91789 12.1679 9.75 12.375 9.75C12.5821 9.75 12.75 9.91789 12.75 10.125C12.75 10.3321 12.5821 10.5 12.375 10.5Z"
            fill={
              pathname.includes("/billing")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M12.375 10.3125C12.2714 10.3125 12.1875 10.2286 12.1875 10.125C12.1875 10.0214 12.2714 9.9375 12.375 9.9375C12.4786 9.9375 12.5625 10.0214 12.5625 10.125C12.5625 10.2286 12.4786 10.3125 12.375 10.3125ZM13.3125 10.125C13.3125 9.60723 12.8928 9.1875 12.375 9.1875C11.8572 9.1875 11.4375 9.60723 11.4375 10.125C11.4375 10.6428 11.8572 11.0625 12.375 11.0625C12.8928 11.0625 13.3125 10.6428 13.3125 10.125Z"
            fill={
              pathname.includes("/billing")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M12.9375 4.20425C12.9375 3.58829 12.3536 3.13969 11.7584 3.29841L3.50844 5.49841C3.09805 5.60784 2.8125 5.97952 2.8125 6.40425V6.75183H1.6875V6.40425C1.6875 5.46983 2.3157 4.65216 3.21857 4.41139L11.4686 2.21139C12.7779 1.86223 14.0625 2.84912 14.0625 4.20425V5.25183H12.9375V4.20425Z"
            fill={
              pathname.includes("/billing")
                ? "#284CB3"
                : mode === "dark"
                ? "#EAEAEA"
                : "#000000"
            }
          />
        </svg>
      ),
      children: [
        {
          title: "Billing",
          href: "/billing",
          children: [],
        },
      ],
    },
  ];

  const routes = links.filter((link) =>
    link.allowedRoles?.includes(user?.role.name)
  );

  return (
    <div className="flex items-start md:h-screen max-w-[400px]">
      <div className="border-end pt-8 w-fit h-full">
        <div className="w-[62px] h-[66px] flex items-center justify-center">
          <Link
            to={"/dashboard"}
            onClick={() => {
              setPageTitle("Dashboar");
              setTopTitle("Dashboar");
              setChildren(links[0].children!);
            }}
          >
            {mode === "dark" ? (
              <img src={logoMono} alt="cloud logo" />
            ) : (
              <img src={logoColored} alt="cloud logo" />
            )}
          </Link>
        </div>
        <div className="h-[90vh] overflow-scroll">
          <div className="pr-2 pr-md-0">
            {routes.map((link) => (
              <div
                role="button"
                key={link.title}
                title={link.title}
                className="flex items-center gap-2 w-[62px] h-[66px]"
                onClick={() => {
                  setPageTitle(link.children![0].title);
                  sessionStorage.setItem("top-title", link.title);
                  if (link.children) {
                    sessionStorage.setItem(
                      "children",
                      JSON.stringify(link.children)
                    );
                  }
                }}
              >
                {pathname.includes(link.path) ? (
                  <svg
                    width="6"
                    height="50"
                    viewBox="0 0 6 50"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M0 0C3.31371 0 6 2.68629 6 6V44C6 47.3137 3.31371 50 0 50V0Z"
                      fill="#284CB3"
                    />
                  </svg>
                ) : (
                  <svg
                    width="6"
                    height="50"
                    viewBox="0 0 6 50"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M0 0C3.31371 0 6 2.68629 6 6V44C6 47.3137 3.31371 50 0 50V0Z"
                      fill={mode === "dark" ? "#101222" : "#FFFFFF"}
                    />
                  </svg>
                )}
                <Link
                  to={link.href!}
                  key={link.title}
                  className="md:pl-2"
                  onClick={() => {
                    setPageTitle(link.children![0].title);
                    sessionStorage.setItem("top-title", link.title);
                    if (link.children) {
                      setTopTitle(link.title);
                      setChildren(link.children!);
                      setIsOpen(true);
                    } else {
                      setIsOpen(false);
                    }
                  }}
                >
                  {link.icon}
                </Link>
              </div>
            ))}
          </div>
          {/* <div className="absolute bottom-12 left-5"> */}
          <div
            title="profile"
            className="w-[62px] h-[66px] flex items-center justify-center"
          >
            <button
              onClick={() => {
                setPopOpen(!popOpen);
              }}
              className="rounded-full p-2 bg-primary flex items-center justify-center"
            >
              <svg
                width="14px"
                height="14px"
                strokeWidth="1.5"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                color="#FFFFFF"
              >
                <path
                  d="M5 20V19C5 15.134 8.13401 12 12 12V12C15.866 12 19 15.134 19 19V20"
                  stroke="#FFFFFF"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                ></path>
                <path
                  d="M12 12C14.2091 12 16 10.2091 16 8C16 5.79086 14.2091 4 12 4C9.79086 4 8 5.79086 8 8C8 10.2091 9.79086 12 12 12Z"
                  stroke="#FFFFFF"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                ></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
      {popOpen && (
        <div
          className={`${
            mode === "dark" ? "bg-lightDark" : "bg-white"
          } absolute bottom-6 left-12 rounded-md shadow-md w-fit`}
        >
          <div className="menu-item px-5 my-1">
            <Link
              to="/crafted/account/settings"
              className="menu-link font-medium"
              onClick={() => setPopOpen(false)}
            >
              Account Settings
            </Link>
          </div>
          <div className="menu-item px-5 ">
            <Link
              to="/change-password"
              className="menu-link font-medium"
              onClick={() => {
                setPopOpen(false);
                setPageTitle("Change Password");
                sessionStorage.setItem("top-title", "Change Password");
              }}
            >
              Change Password
            </Link>
          </div>
          <div className="menu-item px-5 ">
            <a
              onClick={() => {
                logout();
                setPopOpen(false);
                sessionStorage.clear();
                localStorage.clear();
              }}
              className="menu-link font-medium"
            >
              Sign Out
            </a>
          </div>
        </div>
      )}
      {isOpen && children.length > 0 && (
        <div className="pt-6 w-full md:max-w-[300px] h-full">
          <div className="menu-item w-full mb-[16px]">
            <div className="menu-content pt-8 pb-2 flex items-center justify-between">
              <span
                className={`${
                  mode === "dark" ? "text-[#909BBC]" : "text-[#6A6A6A]"
                } menu-section text-[12px] font-medium text-muted text-uppercase fs-8 ls-1`}
              >
                {topTitle}
              </span>
              <svg
                width="18"
                height="18"
                viewBox="0 0 18 18"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M1.6875 14.25C1.6875 15.3891 2.61091 16.3125 3.75 16.3125H14.25C15.3891 16.3125 16.3125 15.3891 16.3125 14.25V3.75C16.3125 2.61091 15.3891 1.6875 14.25 1.6875L3.75 1.6875C2.61091 1.6875 1.6875 2.61091 1.6875 3.75L1.6875 14.25ZM3.75 15.1875C3.23223 15.1875 2.8125 14.7678 2.8125 14.25L2.8125 3.75C2.8125 3.23223 3.23223 2.8125 3.75 2.8125L14.25 2.8125C14.7678 2.8125 15.1875 3.23223 15.1875 3.75L15.1875 14.25C15.1875 14.7678 14.7678 15.1875 14.25 15.1875L3.75 15.1875Z"
                  fill={mode === "dark" ? "#EAEAEA" : "#6A6A6A"}
                />
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M7.125 16.3125C7.43566 16.3125 7.6875 16.0607 7.6875 15.75V2.25C7.6875 1.93934 7.43566 1.6875 7.125 1.6875C6.81434 1.6875 6.5625 1.93934 6.5625 2.25V15.75C6.5625 16.0607 6.81434 16.3125 7.125 16.3125Z"
                  fill={mode === "dark" ? "#EAEAEA" : "#6A6A6A"}
                />
              </svg>
            </div>
          </div>
          <div className="w-full flex items-start flex-col gap-[16px] px-5">
            {children.map((child) => {
              if (child?.children!?.length > 0) {
                return (
                  <div key={child?.title}>
                    <h1 className="font-semibold text-[14px] mb-[16px] text-start">
                      {child?.title}
                    </h1>
                    <div className="pl-[12px] flex flex-col gap-[8px]">
                      {child?.children!?.map((grandChild) => (
                        <Link
                          key={grandChild?.href!}
                          to={grandChild?.href!}
                          className={`menu-link without-sub w-full flex items-center justify-between mb-[16px] ${
                            pathname === grandChild?.href!
                              ? "text-primary bg-[#284CB31A] font-semibold text-[12px] px-[10px] py-[8px] rounded-[8px] w-full"
                              : "py-[8px] w-full font-medium hover:text-primary hover:bg-[#284CB31A] hover:px-2 hover:rounded-[8px] hover:font-medium"
                          }`}
                          onClick={() => {
                            if(child?.title === "Container Security") {
                              setPageTitle(`Container Security / ${grandChild?.title}`);
                            }else {
                              setPageTitle(`IAC Security / ${grandChild?.title}`);
                            }
                            
                            sessionStorage.removeItem("cur_policy_page");
                          }}
                        >
                          {grandChild?.title}{" "}
                          {grandChild?.hasTag && (
                            <div className="rounded-full px-[6px] py-[2px] flex bg-[#284CB30D] text-primary font-medium items-center gap-[2px]">
                              <svg
                                width="12"
                                height="13"
                                viewBox="0 0 12 13"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                              >
                                <path
                                  fillRule="evenodd"
                                  clipRule="evenodd"
                                  d="M6 10.125C8.27817 10.125 10.125 8.27817 10.125 6V3.5C10.125 3.15482 9.84518 2.875 9.5 2.875H2.5C2.15482 2.875 1.875 3.15482 1.875 3.5V6C1.875 8.27817 3.72183 10.125 6 10.125ZM10.875 6C10.875 8.69239 8.69239 10.875 6 10.875C3.30761 10.875 1.125 8.69239 1.125 6V3.5C1.125 2.74061 1.74061 2.125 2.5 2.125H9.5C10.2594 2.125 10.875 2.74061 10.875 3.5V6Z"
                                  fill="#284CB3"
                                />
                                <path
                                  fillRule="evenodd"
                                  clipRule="evenodd"
                                  d="M3.73483 5.23483C3.88128 5.08839 4.11872 5.08839 4.26517 5.23483L6 6.96967L7.73483 5.23483C7.88128 5.08839 8.11872 5.08839 8.26516 5.23483C8.41161 5.38128 8.41161 5.61872 8.26516 5.76517L6.26517 7.76517C6.11872 7.91161 5.88128 7.91161 5.73483 7.76517L3.73483 5.76517C3.58839 5.61872 3.58839 5.38128 3.73483 5.23483Z"
                                  fill="#284CB3"
                                />
                              </svg>
                              <small>Soon</small>
                            </div>
                          )}
                        </Link>
                      ))}
                    </div>
                  </div>
                );
              }
              return (
                <Link
                  key={child?.href!}
                  to={child.href!}
                  className={`menu-link without-sub w-full font-semibold flex items-center justify-between mb-[16px] ${
                    pathname === child.href!
                      ? "text-primary bg-[#284CB31A] font-semibold text-[14px] px-[12px] py-[10px] rounded-[8px] w-full"
                      : "py-[10px] w-full font-medium hover:text-primary hover:bg-[#284CB31A] hover:px-2 hover:rounded-[8px] hover:font-medium"
                  }`}
                  onClick={() => setPageTitle(child.title)}
                >
                  {child.title}{" "}
                  {child?.hasTag && (
                    <div className="rounded-full px-[6px] py-[2px] flex bg-[#284CB30D] text-primary font-medium items-center gap-[2px]">
                      <svg
                        width="12"
                        height="13"
                        viewBox="0 0 12 13"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          fillRule="evenodd"
                          clipRule="evenodd"
                          d="M6 10.125C8.27817 10.125 10.125 8.27817 10.125 6V3.5C10.125 3.15482 9.84518 2.875 9.5 2.875H2.5C2.15482 2.875 1.875 3.15482 1.875 3.5V6C1.875 8.27817 3.72183 10.125 6 10.125ZM10.875 6C10.875 8.69239 8.69239 10.875 6 10.875C3.30761 10.875 1.125 8.69239 1.125 6V3.5C1.125 2.74061 1.74061 2.125 2.5 2.125H9.5C10.2594 2.125 10.875 2.74061 10.875 3.5V6Z"
                          fill="#284CB3"
                        />
                        <path
                          fillRule="evenodd"
                          clipRule="evenodd"
                          d="M3.73483 5.23483C3.88128 5.08839 4.11872 5.08839 4.26517 5.23483L6 6.96967L7.73483 5.23483C7.88128 5.08839 8.11872 5.08839 8.26516 5.23483C8.41161 5.38128 8.41161 5.61872 8.26516 5.76517L6.26517 7.76517C6.11872 7.91161 5.88128 7.91161 5.73483 7.76517L3.73483 5.76517C3.58839 5.61872 3.58839 5.38128 3.73483 5.23483Z"
                          fill="#284CB3"
                        />
                      </svg>
                      <small>Soon</small>
                    </div>
                  )}
                </Link>
              );
            })}
          </div>
        </div>
      )}
    </div>
  );
};

export default NewSideMenu;
